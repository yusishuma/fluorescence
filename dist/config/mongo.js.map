{"version":3,"sources":["../../config/mongo.js"],"names":[],"mappings":";;;;;AAGA,IAAI,QAAQ,GAAG,OAAO,CAAC,UAAU,CAAC,CAAC;AACnC,IAAI,MAAM,GAAG,OAAO,CAAC,6BAA6B,CAAC,CAAC,MAAM,CAAC;AAC3D,OAAO,CAAC,QAAQ,CAAC,CAAC,MAAM,EAAE,CAAC;;AAE3B,IAAI,YAAY,GAAG,SAAf,YAAY,GAAe;AAC3B,gBAAY,CAAC;AACb,WAAO,QAAQ,CAAC,OAAO,CAAC,gCAAgC,EAAE;AACtD,cAAM,EAAE,KAAK;;KAEhB,EAAE,UAAU,GAAG,EAAE;AACd,YAAI,GAAG,EAAE;AACL,kBAAM,CAAC,IAAI,CAAC,wBAAwB,EAAE,OAAO,CAAC,GAAG,CAAC,cAAc,GAAG,IAAI,CAAC,CAAC;AACzE,sBAAU,CAAC,YAAY,EAAE,OAAO,CAAC,GAAG,CAAC,cAAc,CAAC,CAAC;SAExD,MACI;AACD,kBAAM,CAAC,IAAI,CAAC,aAAa,CAAC,CAAC;SAC9B;KACJ,CAAC,CAAC;CACN,CAAC;AACF,OAAO,CAAC,eAAe,GAAG,QAAQ,CAAC,gBAAgB,CAAC,OAAO,CAAC,GAAG,CAAC,MAAM,CAAC,CAAC;AACxE,QAAQ,CAAC,OAAO,GAAG,OAAO,CAAC,GAAG,CAAC,CAAC,OAAO,CAAC;AACxC,OAAO,CAAC,YAAY,GAAG,YAAY,CAAC","file":"mongo.js","sourcesContent":["/**\n * Created by matonghe on 15/03/2017.\n */\nvar mongoose = require(\"mongoose\");\nvar logger = require(\"../middlewares/log4j/logger\").logger;\nrequire('dotenv').config();\n// 自动重练mongodb\nvar connectMongo = function () {\n    \"use strict\";\n    return mongoose.connect(\"mongodb://localhost:27017/test\", {\n        mongos: false\n\n    }, function (err) {\n        if (err) {\n            logger.warn('与mongodb断开连接 %ssec 后重试', process.env.RECONNECT_TIME / 1000);\n            setTimeout(connectMongo, process.env.RECONNECT_TIME);\n\n        }\n        else {\n            logger.info('已连接到mongodb');\n        }\n    });\n};\nexports.mongoConnection = mongoose.createConnection(process.env.DB_URI);\nmongoose.Promise = require('q').Promise;\nexports.connectMongo = connectMongo;"]}